# SPDX-FileCopyrightText: Copyright (c) 2024 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
# SPDX-License-Identifier: Apache-2.0
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#  http://www.apache.org/licenses/LICENSE-2.0
#
#  Unless required by applicable law or agreed to in writing, software
#  distributed under the License is distributed on an "AS IS" BASIS,
#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
#  See the License for the specific language governing permissions and
#  limitations under the License.

# GXF CMake Export Rules

## Overview

Package CMake rules from this directory within a GXF release archive to add built-in support
for external projects based on CMake to consume GXF as a dependency.

## Background

Internally, GXF supports building with Bazel as a first-class citizen
and does not support building with CMake.

Externally, other projects using GXF may internally use Bazel or CMake
for their build system. To lessen the development burden for external
developers, we want to support both build systems within a given
GXF release.

## Prerequisites

Refer to the [release README documentation](../README) for packaging requirements.

CMake >=3.0 is required to consume CMake rules. CMake 3.24 was used in testing,
we recommend using that version.

## Usage

Configure an external, CMake-based project to point to the binary
folder for the appropriate target platform:
```sh
$ cmake -DGXF_DIR:PATH=path/to/GXF-release/gxf_<platform>/cmake/GXF -S<my_project_source>
```

## Contents

Typically, CMake export files are generated by CMake at build/install time.
We have forked generated CMake export files from other projects as a template
and manually updated with targets and relative paths to describe the
GXF release tarball contents.

- `GXFConfig.cmake` is the entry point for the CMake `find_package` call in
  the external project and is responsible for finding dependencies
  not distributed with the GXF release.
- `GXFConfigVersion.cmake` contains version matching information. It must be
  manually updated each time the GXF version is incremented in Bazel.
- `GXFTargets.cmake` defines GXF targets describing packaged libraries.
- `GXFTargets-release.cmake` defines GXF target locations for the given
  platform subdirectory. The `-release` suffix indicates that we expect release
  binaries to be built in "Release" mode.
